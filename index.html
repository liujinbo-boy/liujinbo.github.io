<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>欢迎家访 | 个人博客</title>
  <!-- 引入Font Awesome图标 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <!-- 引入代码高亮样式 -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/atom-one-light.min.css">
  <style>
    :root {
      --bg-color: #F8F9FA; /* 柔和护眼背景色 */
      --text-color: #333;  /* 文字主色 */
      --light-text: #666;  /* 次要文字色 */
      --card-bg: #FFFFFF;  /* 卡片背景 */
      --card-shadow: 0 2px 8px rgba(0, 0, 0, 0.06); /* 柔和阴影 */
      --hover-shadow: 0 6px 16px rgba(0, 0, 0, 0.09); /* hover阴影 */
      --avatar-border: 4px solid rgba(54, 207, 201, 0.15); /* 头像边框 */
      --transition: all 0.3s ease-in-out; /* 流畅过渡 */
      --spacing: 8px; /* 基础间距 */

      /* 新分类颜色（柔和且区分明显，支持后期扩展） */
      --category-video: #165DFF;    /* 音视频：科技蓝 */
      --category-essay: #722ED1;    /* 随笔：温柔紫 */
      --category-note: #F7BA1E;     /* 学习笔记：暖黄 */
      --category-life: #36CFC9;     /* 生活记录：青绿 */
      --category-env: #27AE60;      /* 环境搭建：森林绿（新增） */
      --category-all: #86909C;      /* 全部：浅灰 */
      --gallery-mask: rgba(0, 0, 0, 0.85); /* 图片画廊遮罩色 */
      --blog-modal-mask: rgba(0, 0, 0, 0.7); /* 博客详情遮罩色 */
      --toc-bg: #fafafa; /* 目录背景色 */
      --toc-active: #165DFF; /* 目录激活色 */
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', 'PingFang SC', 'Microsoft YaHei', 'Helvetica Neue', sans-serif;
      background-color: var(--bg-color);
      color: var(--text-color);
      line-height: 1.7;
      padding-bottom: 60px;
      overflow-x: hidden; /* 防止画廊滑动时页面横向滚动 */
    }

    .container {
      max-width: 1100px;
      margin: 0 auto;
      padding: 20px 15px;
    }

    /* 导航栏 */
    .navbar {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 20px 0;
      margin-bottom: 20px;
      border-bottom: 1px solid rgba(0,0,0,0.05);
    }

    .logo {
      font-size: 26px;
      font-weight: 600;
      color: var(--category-video);
      letter-spacing: 0.5px;
    }

    /* 个人介绍区域 */
    .profile {
      display: flex;
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--card-shadow);
      padding: 30px;
      margin-bottom: 30px;
      transition: var(--transition);
      align-items: center;
    }

    .profile:hover {
      box-shadow: var(--hover-shadow);
      transform: translateY(-2px);
    }

    /* 圆形头像强化 */
    .profile-avatar {
      width: 130px;
      height: 130px;
      border-radius: 50%;
      object-fit: cover;
      margin-right: 30px;
      border: var(--avatar-border);
      box-shadow: 0 3px 10px rgba(0,0,0,0.08);
      transition: var(--transition);
    }

    .profile-avatar:hover {
      transform: scale(1.03);
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .profile-info {
      flex: 1;
    }

    .profile-name {
      font-size: 26px;
      margin-bottom: 6px;
      color: var(--text-color);
      font-weight: 600;
    }

    .profile-desc {
      color: var(--light-text);
      margin-bottom: 12px;
      font-size: 15px;
    }

    .profile-bio {
      margin-bottom: 18px;
      line-height: 1.8;
      font-size: 15px;
      color: var(--text-color);
    }

    .tech-stack, .hobbies {
      display: flex;
      flex-wrap: wrap;
      margin-top: 8px;
      gap: 8px;
    }

    .tech-item, .hobby-item {
      background-color: rgba(54, 207, 201, 0.08);
      color: var(--category-life);
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 14px;
      transition: var(--transition);
    }

    .tech-item:hover, .hobby-item:hover {
      background-color: rgba(54, 207, 201, 0.15);
      transform: translateY(-1px);
    }

    /* 联系区域 */
    .contact {
      display: flex;
      flex-wrap: wrap;
      margin-top: 18px;
      gap: 15px;
    }

    .contact-item {
      display: flex;
      align-items: center;
      color: var(--light-text);
      text-decoration: none;
      transition: var(--transition);
      font-size: 14px;
      padding: 4px 8px;
      border-radius: 4px;
    }

    .contact-item i {
      font-size: 18px;
      margin-right: 6px;
    }

    .contact-item:hover {
      color: var(--category-video);
      background-color: rgba(22, 93, 255, 0.05);
    }

    /* 博客标题+搜索栏 组合 */
    .works-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
      gap: 12px;
    }

    .works-title {
      font-size: 22px;
      font-weight: 600;
      color: var(--text-color);
      padding-bottom: 4px;
      border-bottom: 2px solid var(--category-video);
    }

    /* 搜索栏 */
    .blog-search-box {
      display: flex;
      align-items: center;
      width: 280px;
      max-width: 100%;
    }

    .blog-search-box input {
      flex: 1;
      padding: 9px 14px;
      border: 1px solid #e1e4e8;
      border-radius: 6px 0 0 6px;
      outline: none;
      font-size: 14px;
      transition: var(--transition);
      background-color: rgba(255,255,255,0.8);
    }

    .blog-search-box input:focus {
      border-color: var(--category-video);
      box-shadow: 0 0 0 2px rgba(22, 93, 255, 0.1);
    }

    .blog-search-box button {
      padding: 9px 14px;
      background-color: var(--category-video);
      color: white;
      border: none;
      border-radius: 0 6px 6px 0;
      cursor: pointer;
      transition: var(--transition);
      font-size: 14px;
    }

    .blog-search-box button:hover {
      background-color: #0e42d2;
      transform: translateY(-1px);
    }

    /* 美化分类按钮（核心优化） */
    .category-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 12px;
      margin-bottom: 25px;
      justify-content: center;
    }

    .category-btn {
      padding: 8px 20px;
      border: none;
      border-radius: 24px; /* 超圆润按钮 */
      color: white;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 2px 6px rgba(0,0,0,0.08);
      display: flex;
      align-items: center;
      gap: 8px; /* 图标与文字间距 */
      background: linear-gradient(135deg, var(--category-all), var(--category-all)); /* 基础渐变 */
    }

    /* 每个分类专属渐变+图标 */
    .category-btn.all {
      background: linear-gradient(135deg, var(--category-all), #6c757d);
    }
    .category-btn.video {
      background: linear-gradient(135deg, var(--category-video), #0e42d2);
    }
    .category-btn.essay {
      background: linear-gradient(135deg, var(--category-essay), #5a23b5);
    }
    .category-btn.note {
      background: linear-gradient(135deg, var(--category-note), #d9a518);
    }
    .category-btn.life {
      background: linear-gradient(135deg, var(--category-life), #2ba8a2);
    }
    .category-btn.env { /* 新增环境搭建分类按钮样式 */
      background: linear-gradient(135deg, var(--category-env), #1e8449);
    }

    /* hover/active效果强化 */
    .category-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.12);
      opacity: 0.98;
    }
    .category-btn.active {
      transform: translateY(-2px);
      box-shadow: 0 3px 9px rgba(0,0,0,0.1);
      filter: brightness(1.05); /* 激活时略微提亮 */
    }

    /* 作品区域 */
    .works {
      margin-top: 10px;
    }

    .works-list {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      gap: 22px;
    }

    /* 博客卡片（适配有图/无图/图片类） */
    .work-card {
      background-color: var(--card-bg);
      border-radius: 10px;
      box-shadow: var(--card-shadow);
      overflow: hidden;
      transition: var(--transition);
      display: flex;
      flex-direction: column;
      cursor: pointer; /* 图片类博客卡片添加指针样式 */
    }

    .work-card:hover {
      box-shadow: var(--hover-shadow);
      transform: translateY(-3px);
    }

    /* 有图卡片的图片样式 */
    .work-img {
      width: 100%;
      height: 160px;
      object-fit: cover;
      transition: var(--transition);
    }
    .work-card:hover .work-img {
      transform: scale(1.03);
    }

    /* 无图卡片的美化占位区（核心优化） */
    .work-img-placeholder {
      width: 100%;
      height: 160px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: white;
      transition: var(--transition);
      background: linear-gradient(135deg, var(--category-all), #6c757d); /* 基础渐变 */
      padding: 20px;
      text-align: center;
    }

    /* 无图占位区按分类变色 */
    .work-img-placeholder.video {
      background: linear-gradient(135deg, var(--category-video), #0e42d2);
    }
    .work-img-placeholder.essay {
      background: linear-gradient(135deg, var(--category-essay), #5a23b5);
    }
    .work-img-placeholder.note {
      background: linear-gradient(135deg, var(--category-note), #d9a518);
    }
    .work-img-placeholder.life {
      background: linear-gradient(135deg, var(--category-life), #2ba8a2);
    }
    .work-img-placeholder.env { /* 新增环境搭建分类占位区样式 */
      background: linear-gradient(135deg, var(--category-env), #1e8449);
    }

    .work-img-placeholder i {
      font-size: 36px;
      margin-bottom: 10px;
      opacity: 0.8;
    }
    .work-img-placeholder span {
      font-size: 14px;
      opacity: 0.9;
    }
    .work-card:hover .work-img-placeholder {
      filter: brightness(1.1);
    }

    /* 卡片内容区 */
    .work-content {
      padding: 18px;
      flex: 1;
      display: flex;
      flex-direction: column;
    }

    /* 分类标签 */
    .work-category {
      display: inline-block;
      padding: 3px 10px;
      border-radius: 6px;
      font-size: 12px;
      color: white;
      margin-bottom: 10px;
      font-weight: 500;
      background-color: var(--category-all);
    }

    /* 分类标签颜色适配 */
    .work-category.video {
      background-color: var(--category-video);
    }
    .work-category.essay {
      background-color: var(--category-essay);
    }
    .work-category.note {
      background-color: var(--category-note);
    }
    .work-category.life {
      background-color: var(--category-life);
    }
    .work-category.env { /* 新增环境搭建分类标签样式 */
      background-color: var(--category-env);
    }

    /* 图片类博客标识 */
    .image-gallery-tag {
      display: inline-block;
      margin-left: 8px;
      padding: 1px 6px;
      background-color: rgba(22, 93, 255, 0.1);
      color: var(--category-video);
      font-size: 11px;
      border-radius: 3px;
    }

    .work-title {
      font-size: 17px;
      margin-bottom: 10px;
      color: var(--text-color);
      font-weight: 600;
      line-height: 1.5;
    }

    .work-excerpt {
      color: var(--light-text);
      margin-bottom: 15px;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
      font-size: 14px;
      flex: 1;
    }

    .work-link {
      display: inline-block;
      color: var(--category-video);
      text-decoration: none;
      font-weight: 500;
      transition: var(--transition);
      font-size: 14px;
      align-self: flex-start;
      cursor: pointer; /* 改为指针样式 */
    }

    .work-link:hover {
      text-decoration: underline;
      color: #0e42d2;
    }

    .work-link i {
      margin-left: 4px;
      font-size: 12px;
    }

    /* 图片画廊弹窗（核心新增） */
    .image-gallery {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: var(--gallery-mask);
      z-index: 9999;
      display: none;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .gallery-active {
      display: flex;
    }

    .gallery-container {
      position: relative;
      width: 100%;
      max-width: 1200px;
      height: 80vh;
      max-height: 800px;
    }

    .gallery-slide {
      width: 100%;
      height: 100%;
      border-radius: 8px;
      overflow: hidden;
    }

    .gallery-img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      background-color: rgba(0,0,0,0.2);
    }

    /* 画廊控制按钮 */
    .gallery-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background-color: rgba(255,255,255,0.2);
      color: white;
      border: none;
      font-size: 24px;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      backdrop-filter: blur(4px);
    }

    .gallery-btn:hover {
      background-color: rgba(255,255,255,0.3);
    }

    .gallery-prev {
      left: -60px;
    }

    .gallery-next {
      right: -60px;
    }

    /* 画廊关闭按钮 */
    .gallery-close {
      position: absolute;
      top: -40px;
      right: 0;
      color: white;
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      transition: var(--transition);
    }

    .gallery-close:hover {
      color: #ddd;
    }

    /* 画廊图片索引 */
    .gallery-index {
      position: absolute;
      bottom: -30px;
      left: 0;
      color: white;
      font-size: 14px;
    }

    /* 触摸滑动样式 */
    .gallery-slide-container {
      width: 100%;
      height: 100%;
      overflow: hidden;
      position: relative;
    }

    .gallery-slide-wrapper {
      display: flex;
      height: 100%;
      transition: transform 0.3s ease-in-out;
    }

    .gallery-slide-item {
      min-width: 100%;
      height: 100%;
    }

    /* 博客详情弹窗（核心新增：解析MD） */
    .blog-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: var(--blog-modal-mask);
      z-index: 9999;
      display: none;
      align-items: flex-start;
      justify-content: center;
      padding: 40px 20px;
      overflow-y: auto;
    }

    .blog-modal-active {
      display: flex;
    }

    .blog-modal-content {
      width: 100%;
      max-width: 1200px; /* 加宽弹窗以容纳目录 */
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      padding: 30px;
      position: relative;
      margin-bottom: 40px;
      display: flex; /* 改为弹性布局 */
      gap: 25px;
    }

    /* 固定位置的关闭按钮 */
    .blog-modal-close {
      position: fixed; /* 改为固定定位 */
      top: 20px;
      right: 20px;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background-color: rgba(0,0,0,0.7);
      color: white;
      border: none;
      font-size: 18px;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000; /* 确保在最上层 */
      box-shadow: 0 2px 10px rgba(0,0,0,0.3);
    }

    .blog-modal-close:hover {
      background-color: rgba(0,0,0,0.9);
      transform: scale(1.05);
    }

    /* 目录栏样式 */
    .blog-toc {
      width: 260px;
      flex-shrink: 0;
      background-color: var(--toc-bg);
      border-radius: 8px;
      padding: 20px;
      height: calc(100vh - 120px); /* 固定高度 */
      position: sticky;
      top: 30px;
      overflow-y: auto;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }

    .toc-title {
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 15px;
      color: var(--text-color);
      display: flex;
      align-items: center;
      gap: 8px;
      padding-bottom: 8px;
      border-bottom: 1px solid #eee;
    }

    .toc-list {
      list-style: none;
    }

    .toc-item {
      margin-bottom: 8px;
    }

    .toc-link {
      text-decoration: none;
      color: var(--light-text);
      font-size: 14px;
      display: block;
      padding: 4px 8px;
      border-radius: 4px;
      transition: var(--transition);
    }

    .toc-link:hover {
      color: var(--toc-active);
      background-color: rgba(22, 93, 255, 0.05);
    }

    .toc-link.active {
      color: var(--toc-active);
      font-weight: 500;
      background-color: rgba(22, 93, 255, 0.1);
    }

    /* 标题层级缩进 */
    .toc-level-2 {
      padding-left: 15px;
    }
    .toc-level-3 {
      padding-left: 30px;
    }
    .toc-level-4 {
      padding-left: 45px;
    }
    .toc-level-5 {
      padding-left: 60px;
    }
    .toc-level-6 {
      padding-left: 75px;
    }

    /* 博客内容区域 - 核心修改：添加滚动容器 */
    .blog-content-wrapper {
      flex: 1;
      padding-bottom: 30px;
      max-height: calc(100vh - 120px); /* 固定最大高度，与目录栏一致 */
      overflow-y: auto; /* 内容溢出时显示滚动条 */
      scroll-behavior: smooth; /* 平滑滚动 */
      padding-right: 10px; /* 给滚动条留空间 */
    }

    /* 滚动条美化 */
    .blog-content-wrapper::-webkit-scrollbar {
      width: 6px;
    }
    .blog-content-wrapper::-webkit-scrollbar-track {
      background: #f1f1f1;
      border-radius: 3px;
    }
    .blog-content-wrapper::-webkit-scrollbar-thumb {
      background: #ccc;
      border-radius: 3px;
    }
    .blog-content-wrapper::-webkit-scrollbar-thumb:hover {
      background: #999;
    }

    .blog-modal-header {
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 1px solid rgba(0,0,0,0.05);
    }

    .blog-modal-category {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 6px;
      font-size: 13px;
      color: white;
      margin-bottom: 10px;
      font-weight: 500;
    }

    .blog-modal-title {
      font-size: 24px;
      margin-bottom: 10px;
      color: var(--text-color);
      line-height: 1.6;
    }

    .blog-modal-meta {
      color: var(--light-text);
      font-size: 14px;
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .blog-modal-meta i {
      margin-right: 4px;
    }

    /* MD解析后的内容样式（美化） */
    .blog-modal-body {
      color: var(--text-color);
      line-height: 1.8;
      font-size: 16px;
    }

    .blog-modal-body h1,
    .blog-modal-body h2,
    .blog-modal-body h3,
    .blog-modal-body h4,
    .blog-modal-body h5,
    .blog-modal-body h6 {
      margin: 25px 0 15px;
      color: var(--text-color);
      font-weight: 600;
      scroll-margin-top: 20px; /* 滚动偏移量，适配内容区域滚动 */
    }

    .blog-modal-body h1 {
      font-size: 28px;
      border-bottom: 1px solid #eee;
      padding-bottom: 10px;
    }

    .blog-modal-body h2 {
      font-size: 24px;
      border-bottom: 1px solid #eee;
      padding-bottom: 8px;
    }

    .blog-modal-body h3 {
      font-size: 20px;
    }

    .blog-modal-body p {
      margin-bottom: 18px;
    }

    .blog-modal-body img {
      max-width: 100%;
      border-radius: 8px;
      margin: 20px 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
    }

    .blog-modal-body a {
      color: var(--category-video);
      text-decoration: none;
      border-bottom: 1px solid rgba(22, 93, 255, 0.3);
      transition: var(--transition);
    }

    .blog-modal-body a:hover {
      color: #0e42d2;
      border-bottom-color: var(--category-video);
    }

    .blog-modal-body ul,
    .blog-modal-body ol {
      margin: 15px 0 15px 25px;
      padding-left: 10px;
    }

    .blog-modal-body li {
      margin-bottom: 8px;
    }

    .blog-modal-body blockquote {
      border-left: 4px solid var(--category-video);
      padding: 10px 15px;
      margin: 15px 0;
      background-color: rgba(22, 93, 255, 0.03);
      border-radius: 0 4px 4px 0;
    }

    .blog-modal-body code {
      background-color: rgba(0,0,0,0.04);
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 15px;
      font-family: 'Consolas', 'Monaco', monospace;
    }

    .blog-modal-body pre {
      background-color: #f8f9fa;
      border-radius: 8px;
      padding: 15px;
      margin: 20px 0;
      overflow-x: auto;
      border: 1px solid #eee;
    }

    .blog-modal-body pre code {
      background: none;
      padding: 0;
      font-size: 14px;
    }

    .blog-modal-loading {
      text-align: center;
      padding: 60px 20px;
      color: var(--light-text);
    }

    .blog-modal-loading i {
      font-size: 48px;
      margin-bottom: 15px;
      color: var(--category-video);
      animation: spin 1.5s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .blog-modal-error {
      text-align: center;
      padding: 60px 20px;
      color: var(--light-text);
    }

    .blog-modal-error i {
      font-size: 48px;
      margin-bottom: 15px;
      color: #ff4d4f;
    }

    .blog-modal-error button {
      margin-top: 20px;
      padding: 8px 16px;
      background-color: var(--category-video);
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: var(--transition);
    }

    .blog-modal-error button:hover {
      background-color: #0e42d2;
    }

    /* 页脚 */
    .footer {
      text-align: center;
      padding: 25px 0;
      margin-top: 40px;
      border-top: 1px solid rgba(0,0,0,0.05);
      color: var(--light-text);
      font-size: 14px;
    }

    /* 响应式适配 */
    @media (max-width: 1024px) {
      .blog-modal-content {
        flex-direction: column; /* 移动端垂直布局 */
        gap: 20px;
      }

      .blog-toc {
        width: 100%;
        height: auto;
        max-height: 200px;
        position: static;
      }

      .blog-content-wrapper {
        max-height: calc(100vh - 200px); /* 移动端调整高度 */
      }
    }

    @media (max-width: 768px) {
      .profile {
        flex-direction: column;
        align-items: center;
        text-align: center;
        padding: 25px 20px;
      }

      .profile-avatar {
        margin-right: 0;
        margin-bottom: 20px;
        width: 120px;
        height: 120px;
      }

      .tech-stack, .hobbies {
        justify-content: center;
      }

      .contact {
        justify-content: center;
      }

      .works-header {
        flex-direction: column;
        align-items: flex-start;
      }

      .blog-search-box {
        width: 100%;
        margin-top: 8px;
      }

      .category-buttons {
        justify-content: flex-start;
        gap: 8px;
      }

      .category-btn {
        padding: 7px 16px;
        font-size: 13px;
      }

      .works-list {
        grid-template-columns: 1fr;
        gap: 18px;
      }

      .work-img, .work-img-placeholder {
        height: 150px;
      }

      /* 移动端画廊适配 */
      .gallery-container {
        height: 70vh;
      }

      .gallery-btn {
        width: 40px;
        height: 40px;
        font-size: 18px;
      }

      .gallery-prev {
        left: 10px;
      }

      .gallery-next {
        right: 10px;
      }

      .gallery-close {
        top: -35px;
        font-size: 20px;
      }

      .gallery-index {
        bottom: -25px;
      }

      /* 移动端博客详情弹窗适配 */
      .blog-modal {
        padding: 20px 10px;
      }

      .blog-modal-content {
        padding: 20px 15px;
      }

      .blog-modal-title {
        font-size: 20px;
      }

      .blog-modal-body {
        font-size: 15px;
        line-height: 1.7;
      }

      .blog-modal-body h1 {
        font-size: 24px;
      }

      .blog-modal-body h2 {
        font-size: 20px;
      }

      .blog-modal-body h3 {
        font-size: 18px;
      }

      /* 移动端关闭按钮位置调整 */
      .blog-modal-close {
        top: 15px;
        right: 15px;
        width: 36px;
        height: 36px;
      }

      .blog-content-wrapper {
        max-height: calc(100vh - 150px);
      }
    }

    @media (max-width: 480px) {
      .logo {
        font-size: 22px;
      }

      .profile-name {
        font-size: 24px;
      }

      .works-title {
        font-size: 20px;
      }

      .category-btn {
        padding: 6px 12px;
        gap: 6px;
      }

      .category-btn i {
        font-size: 12px;
      }

      .gallery-container {
        height: 60vh;
      }

      /* 移动端目录适配 */
      .blog-toc {
        padding: 15px;
      }

      .toc-title {
        font-size: 15px;
      }

      .toc-link {
        font-size: 13px;
      }

      .blog-content-wrapper {
        max-height: calc(100vh - 120px);
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- 导航栏 -->
    <nav class="navbar">
      <div class="logo">bobo的快乐妙妙屋</div>
    </nav>

    <!-- 个人介绍区域 -->
    <section class="profile">
      <img src="website/bobo.jpg" alt="个人头像" class="profile-avatar">
      <div class="profile-info">
        <h2 class="profile-name">bobo</h2>
        <p class="profile-desc">嵌入式Linux开发工程师 | 技术爱好者 | 生活记录者</p>
        <p class="profile-bio">你好！欢迎来到我的个人小站～ 这里记录了我在嵌入式Linux领域的学习心得、项目实践，以及生活中的点滴瞬间。希望我的分享能给你带来一点帮助，也期待和你一起交流成长！</p>
        <div>
          <strong style="color: var(--light-text); font-weight: 500;">技术栈：</strong>
          <div class="tech-stack">
            <div class="tech-item">嵌入式Linux</div>
            <div class="tech-item">C/C++</div>
            <div class="tech-item">linux应用开发</div>
            <div class="tech-item">音视频</div>
            <div class="tech-item">驱动开发</div>
            <div class="tech-item">单片机</div>
            <div class="tech-item">QT</div>
          </div>
        </div>
        <div style="margin-top: 10px;">
          <strong style="color: var(--light-text); font-weight: 500;">兴趣爱好：</strong>
          <div class="hobbies">
            <div class="hobby-item">编程</div>
            <div class="hobby-item">抽象</div>
            <div class="hobby-item">骑行</div>
            <div class="hobby-item">阅读</div>
            <div class="hobby-item">music</div>
          </div>
        </div>
        <div class="contact">
          <a href="https://github.com/liujinbo-boy" target="_blank" class="contact-item">
            <i class="fab fa-github" style="color: #333;"></i> GitHub链接
          </a>
          <a href="mailto:liujinbo1234@qq.com" target="_blank" class="contact-item">
            <i class="fas fa-envelope" style="color: #1a73e8;"></i> liujinbo1234@qq.com
          </a>
          <a  target="_blank" class="contact-item">
            <i class="fab fa-qq" style="color: #1a73e8;"></i> 3225933788
          </a>
          <a  target="_blank" class="contact-item">
            <i class="fab fa-weixin" style="color: #07c160;"></i> L17752785918
          </a>
        </div>
      </div>
    </section>

    <!-- 博客作品展示区域 -->
    <section class="works">
      <!-- 标题+搜索栏 组合 -->
      <div class="works-header">
        <h2 class="works-title">我的博客作品</h2>
        <div class="blog-search-box">
          <input type="text" id="searchInput" placeholder="搜索关键词（如：驱动开发、环境搭建、生活）...">
          <button onclick="searchBlogs()"><i class="fas fa-search"></i></button>
        </div>
      </div>

      <!-- 美化分类按钮（更新为你的5个分类+全部） -->
      <div class="category-buttons">
        <button class="category-btn all active" onclick="filterByCategory('all')">
          <i class="fas fa-th"></i> 全部
        </button>
        <button class="category-btn video" onclick="filterByCategory('video')">
          <i class="fas fa-video"></i> 音视频
        </button>
        <button class="category-btn env" onclick="filterByCategory('env')"> 
          <i class="fas fa-tools"></i> 环境搭建
        </button>
        <button class="category-btn note" onclick="filterByCategory('note')">
          <i class="fas fa-book-open"></i> 学习笔记
        </button>
        <button class="category-btn essay" onclick="filterByCategory('essay')">
          <i class="fas fa-pen-fancy"></i> 随笔
        </button>
        <button class="category-btn life" onclick="filterByCategory('life')">
          <i class="fas fa-camera-retro"></i> 生活记录
        </button>

      </div>

      <!-- 博客列表 -->
      <div class="works-list" id="worksList">
        <!-- 博客卡片将通过JavaScript动态生成 -->
      </div>
    </section>

    <!-- 页脚 -->
    <footer class="footer">
      <p>© 2025 bobo | 嵌入式Linux技术分享与生活记录</p>
      <p style="margin-top: 6px; font-size: 13px;">愿我们在技术的道路上越走越远，生活越来越精彩～</p>
    </footer>
  </div>

  <!-- 图片画廊弹窗（核心新增） -->
  <div class="image-gallery" id="imageGallery">
    <div class="gallery-container">
      <button class="gallery-close" onclick="closeGallery()"><i class="fas fa-times"></i></button>
      <div class="gallery-slide-container">
        <div class="gallery-slide-wrapper" id="gallerySlideWrapper">
          <!-- 图片将动态插入这里 -->
        </div>
      </div>
      <button class="gallery-btn gallery-prev" onclick="prevSlide()"><i class="fas fa-chevron-left"></i></button>
      <button class="gallery-btn gallery-next" onclick="nextSlide()"><i class="fas fa-chevron-right"></i></button>
      <div class="gallery-index" id="galleryIndex">1/3</div>
    </div>
  </div>

  <!-- 博客详情弹窗（核心新增：解析MD） -->
  <div class="blog-modal" id="blogModal">
    <div class="blog-modal-content">
      <!-- 左侧目录栏 -->
      <div class="blog-toc" id="blogToc">
        <div class="toc-title">
          <i class="fas fa-list"></i> 文章目录
        </div>
        <ul class="toc-list" id="tocList">
          <!-- 目录将动态生成 -->
          <li style="text-align: center; padding: 20px 0; color: var(--light-text); font-size: 14px;">
            加载中...
          </li>
        </ul>
      </div>

      <!-- 右侧内容区域 -->
      <div class="blog-content-wrapper" id="blogContentWrapper">
        <div class="blog-modal-header">
          <span class="blog-modal-category" id="blogModalCategory"></span>
          <h2 class="blog-modal-title" id="blogModalTitle"></h2>
          <div class="blog-modal-meta">
            <span><i class="far fa-calendar-alt"></i> <span id="blogModalDate"></span></span>
            <span><i class="far fa-folder"></i> <span id="blogModalCategoryText"></span></span>
          </div>
        </div>
        <div class="blog-modal-body" id="blogModalBody">
          <!-- 加载状态 -->
          <div class="blog-modal-loading">
            <i class="fas fa-spinner"></i>
            <p>加载中...</p>
          </div>
        </div>
      </div>
    </div>
    <!-- 固定位置的关闭按钮 -->
    <button class="blog-modal-close" onclick="closeBlogModal()"><i class="fas fa-times"></i></button>
  </div>

  <!-- 引入Markdown解析库 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.3.0/marked.min.js"></script>
  <!-- 引入代码高亮库 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
  <script>
      // 初始化代码高亮
    hljs.highlightAll();

    // 全局变量：当前图片画廊索引
    let currentGalleryIndex = 0;
    let currentGalleryImages = [];
    let currentBlogHeadings = []; // 存储当前博客的标题信息
    let scrollListener = null; // 存储滚动监听函数引用，用于移除

    // 分类文本映射（用于博客详情弹窗）- 新增环境搭建映射
    const categoryTextMap = {
      video: '音视频内容',
      env: '环境搭建',
      note: '学习笔记',
      essay: '随笔感悟',
      life: '生活记录',
    };

    // 分类颜色映射（用于博客详情弹窗）
    const categoryColorMap = {
      video: '#165DFF',
      env: '#27AE60',
      note: '#F7BA1E',
      essay: '#722ED1',
      life: '#36CFC9',
    };
    
    const blogData = [
      {
        title: "sip协议中的NAT穿透研究",
        excerpt: "采用sip协议实现双向对讲的过程中，遇到过NAT穿透问题，以下是个人的实战经验总结",
        cover: "", // 无图
        markdown: "blog/sip/SIP中的NAT穿透研究.md",
        keywords: "音视频,NAT,sip",
        category: "video",
        isImageGallery: false, // 普通文字博客
        date: "2025-10-30" // 日期字段
      },
      {
        title: "惠州植物园随拍",
        excerpt: "周末闲暇时光，打卡惠州植物园",
        cover: "good_time/picture/plant2.jpg", // 封面图
        images: [ // 图片类博客：多张图片路径数组
          "good_time/picture/plant2.jpg",
          "good_time/picture/plant1.jpg",
          "good_time/picture/plant3.jpg",
          "good_time/picture/plant4.jpg",
        ],
        keywords: "生活记录,随拍,惠州植物园",
        category: "life",
        isImageGallery: true, // 标记为图片类博客
        date: "2025-11-02"
      },
      {
        title: "网络编程学习笔记",
        excerpt: "底层socket套接字接口的介绍和使用，包括TCP/UDP通信、并发处理等核心知识点",
        cover: "", // 无图
        markdown: "note/网络编程.md",
        keywords: "网络编程,笔记,socket,TCP,UDP",
        category: "note",
        isImageGallery: false,
        date: "2025-10-30" 
      },
      {
        title: "linux系统编程学习笔记",
        excerpt: "入门linux应用开发的笔记，涵盖文件IO、进程管理、线程同步、信号处理等内容",
        cover: "", // 无图
        markdown: "note/linux系统编程.md",
        keywords: "linux,系统编程,笔记,进程,线程",
        category: "note",
        isImageGallery: false, 
        date: "2025-10-30" 
      },
      {
        title: "服务器环境配置笔记",
        excerpt: "详细介绍嵌入式Linux开发环境的完整搭建流程，包括交叉编译、samba服务、调试工具等",
        cover: "", 
        markdown: "note/服务器环境配置.md",
        keywords: "环境搭建,Ubuntu,嵌入式开发,交叉编译,samba",
        category: "env",
        isImageGallery: false,
        date: "2025-10-22"
      },
    ];

    // 生成博客卡片（适配普通博客/图片类博客
    function renderBlogCards(blogs) {
      const worksList = document.getElementById('worksList');
      worksList.innerHTML = '';
      
      if (blogs.length === 0) {
        worksList.innerHTML = `
          <div style="grid-column: 1/-1; text-align: center; padding: 60px 20px; color: var(--light-text); background-color: var(--card-bg); border-radius: 10px; box-shadow: var(--card-shadow);">
            <i class="fas fa-search" style="font-size: 36px; margin-bottom: 15px; color: #ddd;"></i>
            <p style="font-size: 16px; margin-bottom: 8px;">暂无匹配的博客~</p>
            <p style="font-size: 14px;">试试更换关键词或分类吧</p>
          </div>
        `;
        return;
      }

      blogs.forEach(blog => {
        const card = document.createElement('div');
        card.className = 'work-card';
        
        // 分类对应的图标（用于无图占位区）- 新增环境搭建图标
        const categoryIconMap = {
          video: 'fas fa-video',
          essay: 'fas fa-pen-fancy',
          note: 'fas fa-book-open',
          life: 'fas fa-camera-retro',
          env: 'fas fa-tools' // 新增环境搭建图标
        };

        // 动态生成卡片内容（区分普通博客/图片类博客）
        let cardContent = '';
        if (blog.cover) {
          // 有封面图（普通博客/图片类博客共用）
          cardContent = `
            <img src="${blog.cover}" alt="${blog.title}" class="work-img">
            <div class="work-content">
              <span class="work-category ${blog.category}">${categoryTextMap[blog.category]}</span>
              <h3 class="work-title">
                ${blog.title}
                ${blog.isImageGallery ? '<span class="image-gallery-tag"><i class="fas fa-images"></i> 多图</span>' : ''}
              </h3>
              <p class="work-excerpt">${blog.excerpt}</p>
              ${blog.isImageGallery ? '' : '<div class="work-link" onclick="openBlogModal(this)" data-blog-index="' + blogData.indexOf(blog) + '">阅读全文 <i class="fas fa-arrow-right"></i></div>'}
            </div>
          `;
        } else {
          // 无封面图（普通博客）
          cardContent = `
            <div class="work-img-placeholder ${blog.category}">
              <i class="${categoryIconMap[blog.category]}"></i>
              <span>${categoryTextMap[blog.category]}</span>
            </div>
            <div class="work-content">
              <span class="work-category ${blog.category}">${categoryTextMap[blog.category]}</span>
              <h3 class="work-title">${blog.title}</h3>
              <p class="work-excerpt">${blog.excerpt}</p>
              <div class="work-link" onclick="openBlogModal(this)" data-blog-index="${blogData.indexOf(blog)}">阅读全文 <i class="fas fa-arrow-right"></i></div>
            </div>
          `;
        }

        card.innerHTML = cardContent;

        // 绑定点击事件（图片类博客打开画廊，普通博客点击"阅读全文"打开弹窗）
        if (blog.isImageGallery) {
          card.onclick = function() {
            openGallery(blog.images);
          };
        } else {
          // 普通博客：卡片其他区域不响应点击，只有"阅读全文"可点击
          card.style.cursor = 'default';
        }

        worksList.appendChild(card);
      });
    }

    // 打开图片画廊（核心功能）
    function openGallery(images) {
      currentGalleryImages = images;
      currentGalleryIndex = 0;
      
      const galleryWrapper = document.getElementById('gallerySlideWrapper');
      const galleryIndex = document.getElementById('galleryIndex');
      
      // 清空画廊内容
      galleryWrapper.innerHTML = '';
      
      // 插入所有图片
      images.forEach(imgSrc => {
        const slideItem = document.createElement('div');
        slideItem.className = 'gallery-slide-item';
        slideItem.innerHTML = `<img src="${imgSrc}" alt="画廊图片" class="gallery-img">`;
        galleryWrapper.appendChild(slideItem);
      });
      
      // 更新索引
      galleryIndex.textContent = `${currentGalleryIndex + 1}/${images.length}`;
      
      // 显示画廊
      document.getElementById('imageGallery').classList.add('gallery-active');
      
      // 禁止页面滚动
      document.body.style.overflow = 'hidden';
    }

    // 关闭图片画廊（核心功能）
    function closeGallery() {
      document.getElementById('imageGallery').classList.remove('gallery-active');
      document.body.style.overflow = 'auto'; // 恢复页面滚动
    }

    // 上一张图片（核心功能）
    function prevSlide() {
      if (currentGalleryIndex > 0) {
        currentGalleryIndex--;
        updateGallerySlide();
      }
    }

    // 下一张图片（核心功能）
    function nextSlide() {
      if (currentGalleryIndex < currentGalleryImages.length - 1) {
        currentGalleryIndex++;
        updateGallerySlide();
      }
    }

    // 更新画廊滑动位置（核心功能）
    function updateGallerySlide() {
      const galleryWrapper = document.getElementById('gallerySlideWrapper');
      const galleryIndex = document.getElementById('galleryIndex');
      const slideWidth = galleryWrapper.clientWidth;
      
      // 滑动到对应图片
      galleryWrapper.style.transform = `translateX(-${currentGalleryIndex * slideWidth}px)`;
      
      // 更新索引
      galleryIndex.textContent = `${currentGalleryIndex + 1}/${currentGalleryImages.length}`;
    }

    // 触摸滑动支持（核心功能）
    let touchStartX = 0;
    let touchEndX = 0;
    
    const galleryContainer = document.querySelector('.gallery-container');
    galleryContainer.addEventListener('touchstart', function(e) {
      touchStartX = e.touches[0].clientX;
    });
    
    galleryContainer.addEventListener('touchend', function(e) {
      touchEndX = e.changedTouches[0].clientX;
      const touchDiff = touchEndX - touchStartX;
      
      // 滑动距离超过50px才触发切换
      if (touchDiff > 50) {
        prevSlide(); // 向右滑：上一张
      } else if (touchDiff < -50) {
        nextSlide(); // 向左滑：下一张
      }
    });

    // 点击遮罩关闭画廊
    document.getElementById('imageGallery').addEventListener('click', function(e) {
      if (e.target === this) {
        closeGallery();
      }
    });

    // 键盘控制画廊（核心功能）
    document.addEventListener('keydown', function(e) {
      const isGalleryActive = document.getElementById('imageGallery').classList.contains('gallery-active');
      const isBlogModalActive = document.getElementById('blogModal').classList.contains('blog-modal-active');
      
      if (isGalleryActive && !isBlogModalActive) {
        switch(e.key) {
          case 'ArrowLeft':
            prevSlide();
            break;
          case 'ArrowRight':
            nextSlide();
            break;
          case 'Escape':
            closeGallery();
            break;
        }
      } else if (isBlogModalActive && !isGalleryActive) {
        if (e.key === 'Escape') {
          closeBlogModal();
        }
      }
    });

    // 生成文章目录（核心新增）
    function generateTableOfContents(htmlContent) {
      const tempDiv = document.createElement('div');
      tempDiv.innerHTML = htmlContent;
      currentBlogHeadings = [];
      
      // 获取所有标题（h1-h6）
      const headings = tempDiv.querySelectorAll('h1, h2, h3, h4, h5, h6');
      
      if (headings.length === 0) {
        return '<li style="text-align: center; padding: 20px 0; color: var(--light-text); font-size: 14px;">无目录</li>';
      }
      
      // 生成标题数据
      headings.forEach((heading, index) => {
        const level = parseInt(heading.tagName.replace('H', ''));
        const id = `heading-${index}`;
        heading.id = id; // 给标题添加id用于锚点跳转
        
        currentBlogHeadings.push({
          id,
          text: heading.textContent.trim(),
          level
        });
      });
      
      // 生成目录HTML
      let tocHtml = '';
      let currentLevel = 1;
      
      currentBlogHeadings.forEach(heading => {
        const { id, text, level } = heading;
        
        // 处理层级关系
        if (level > currentLevel) {
          // 向下嵌套
          tocHtml += '<ul class="toc-list">';
        } else if (level < currentLevel) {
          // 向上闭合
          tocHtml += '</li>' + '</ul>'.repeat(currentLevel - level) + '</li>';
        } else if (tocHtml) {
          // 同层级，闭合上一个
          tocHtml += '</li>';
        }
        
        // 添加当前标题
        tocHtml += `<li class="toc-item"><a href="#${id}" class="toc-link toc-level-${level}" onclick="scrollToHeading(event, '${id}')">${text}</a>`;
        
        currentLevel = level;
      });
      
      // 闭合所有未闭合的标签
      tocHtml += '</li>' + '</ul>'.repeat(currentLevel - 1);
      
      return tocHtml;
    }

    // 滚动到指定标题（核心修改：改为在内容区域内滚动）
    function scrollToHeading(e, headingId) {
      e.preventDefault(); // 阻止默认锚点跳转
      
      const contentWrapper = document.getElementById('blogContentWrapper');
      const heading = document.getElementById(headingId);
      
      if (heading && contentWrapper) {
        // 计算标题在内容区域内的相对位置
        const headingTop = heading.offsetTop - contentWrapper.offsetTop;
        
        // 在内容区域内平滑滚动
        contentWrapper.scrollTo({
          top: headingTop - 20, // 偏移20px，避免标题贴顶
          behavior: 'smooth'
        });
        
        // 更新目录激活状态
        updateActiveTocItem(headingId);
      }
    }

    // 更新目录激活状态（核心新增）
    function updateActiveTocItem(activeId) {
      const tocLinks = document.querySelectorAll('.toc-link');
      
      tocLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === `#${activeId}`) {
          link.classList.add('active');
        }
      });
    }

    // 监听滚动，更新当前激活的目录项（核心修改：监听内容区域滚动）
    function setupScrollListener() {
      // 先移除之前的监听，避免重复绑定
      if (scrollListener) {
        document.getElementById('blogContentWrapper').removeEventListener('scroll', scrollListener);
      }
      
      const contentWrapper = document.getElementById('blogContentWrapper');
      
      scrollListener = function() {
        const scrollPosition = contentWrapper.scrollTop + 40; // 偏移量，提前激活目录
        let currentActiveId = '';
        
        // 找到当前可视区域的标题
        currentBlogHeadings.forEach((heading, index) => {
          const headingElement = document.getElementById(heading.id);
          if (!headingElement) return;
          
          const headingTop = headingElement.offsetTop - contentWrapper.offsetTop;
          const nextHeadingTop = index < currentBlogHeadings.length - 1 
            ? document.getElementById(currentBlogHeadings[index + 1].id).offsetTop - contentWrapper.offsetTop
            : Infinity;
          
          if (scrollPosition >= headingTop && scrollPosition < nextHeadingTop) {
            currentActiveId = heading.id;
          }
        });
        
        if (currentActiveId) {
          updateActiveTocItem(currentActiveId);
        }
      };
      
      // 绑定滚动监听
      contentWrapper.addEventListener('scroll', scrollListener);
    }

    // 打开博客详情弹窗（核心新增：解析MD）
    function openBlogModal(elem) {
      const blogIndex = elem.getAttribute('data-blog-index');
      const blog = blogData[blogIndex];
      
      // 填充弹窗头部信息
      const modalCategory = document.getElementById('blogModalCategory');
      const modalTitle = document.getElementById('blogModalTitle');
      const modalCategoryText = document.getElementById('blogModalCategoryText');
      const modalDate = document.getElementById('blogModalDate'); // 新增日期显示
      const modalBody = document.getElementById('blogModalBody');
      const tocList = document.getElementById('tocList');
      
      // 重置目录
      tocList.innerHTML = '<li style="text-align: center; padding: 20px 0; color: var(--light-text); font-size: 14px;">加载中...</li>';
      
      // 设置分类标签颜色和文本
      modalCategory.textContent = categoryTextMap[blog.category];
      modalCategory.style.backgroundColor = categoryColorMap[blog.category];
      modalTitle.textContent = blog.title;
      modalCategoryText.textContent = categoryTextMap[blog.category];
      modalDate.textContent = formatDate(blog.date); // 格式化日期显示
      
      // 显示加载状态
      modalBody.innerHTML = `
        <div class="blog-modal-loading">
          <i class="fas fa-spinner"></i>
          <p>加载中...</p>
        </div>
      `;
      
      // 显示弹窗
      document.getElementById('blogModal').classList.add('blog-modal-active');
      document.body.style.overflow = 'hidden'; // 禁止页面滚动
      
      // 加载并解析MD文件
      fetch(blog.markdown)
        .then(response => {
          if (!response.ok) {
            throw new Error('文件加载失败');
          }
          return response.text();
        })
        .then(markdownContent => {
          // 用marked.js解析MD为HTML
          const htmlContent = marked.parse(markdownContent);
          modalBody.innerHTML = htmlContent;
          
          // 代码高亮（解析后重新执行高亮）
          hljs.highlightAll();
          
          // 生成目录
          const tocHtml = generateTableOfContents(htmlContent);
          tocList.innerHTML = tocHtml;
          
          // 设置滚动监听
          setupScrollListener();
        })
        .catch(error => {
          // 显示错误状态
          modalBody.innerHTML = `
            <div class="blog-modal-error">
              <i class="fas fa-exclamation-circle"></i>
              <p>博客加载失败</p>
              <p style="margin-top: 8px; font-size: 14px;">可能是文件路径错误或网络问题</p>
              <button onclick="reloadBlogModal(${blogIndex})">重试</button>
            </div>
          `;
          tocList.innerHTML = '<li style="text-align: center; padding: 20px 0; color: var(--light-text); font-size: 14px;">加载失败</li>';
          console.error('MD文件加载失败：', error);
        });
    }

    // 关闭博客详情弹窗（核心修改：移除滚动监听）
    function closeBlogModal() {
      const blogModal = document.getElementById('blogModal');
      blogModal.classList.remove('blog-modal-active');
      document.body.style.overflow = 'auto'; // 恢复页面滚动
      
      // 移除内容区域的滚动监听
      const contentWrapper = document.getElementById('blogContentWrapper');
      if (scrollListener && contentWrapper) {
        contentWrapper.removeEventListener('scroll', scrollListener);
        scrollListener = null; // 重置监听函数引用
      }
      
      // 重置当前博客标题数据
      currentBlogHeadings = [];
    }

    // 重试加载博客（核心新增）
    function reloadBlogModal(blogIndex) {
      const blog = blogData[blogIndex];
      const modalBody = document.getElementById('blogModalBody');
      const tocList = document.getElementById('tocList');
      
      // 重新显示加载状态
      modalBody.innerHTML = `
        <div class="blog-modal-loading">
          <i class="fas fa-spinner"></i>
          <p>重新加载中...</p>
        </div>
      `;
      tocList.innerHTML = '<li style="text-align: center; padding: 20px 0; color: var(--light-text); font-size: 14px;">加载中...</li>';
      
      // 重新加载并解析MD文件
      fetch(blog.markdown)
        .then(response => {
          if (!response.ok) {
            throw new Error('文件加载失败');
          }
          return response.text();
        })
        .then(markdownContent => {
          const htmlContent = marked.parse(markdownContent);
          modalBody.innerHTML = htmlContent;
          hljs.highlightAll(); // 代码高亮
          
          // 生成目录
          const tocHtml = generateTableOfContents(htmlContent);
          tocList.innerHTML = tocHtml;
          
          // 重新设置滚动监听
          setupScrollListener();
        })
        .catch(error => {
          modalBody.innerHTML = `
            <div class="blog-modal-error">
              <i class="fas fa-exclamation-circle"></i>
              <p>仍然加载失败</p>
              <p style="margin-top: 8px; font-size: 14px;">请检查MD文件路径是否正确</p>
              <button onclick="reloadBlogModal(${blogIndex})">再次重试</button>
            </div>
          `;
          tocList.innerHTML = '<li style="text-align: center; padding: 20px 0; color: var(--light-text); font-size: 14px;">加载失败</li>';
          console.error('MD文件重新加载失败：', error);
        });
    }

    // 分类过滤功能
    function filterByCategory(category) {
      // 更新按钮激活状态
      document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
      document.querySelector(`.category-btn.${category}`).classList.add('active');
      
      // 过滤博客
      let filteredBlogs = blogData;
      if (category !== 'all') {
        filteredBlogs = blogData.filter(blog => blog.category === category);
      }
      renderBlogCards(filteredBlogs);
    }

    // 搜索功能（补全截断部分）
    function searchBlogs() {
      const searchInput = document.getElementById('searchInput').value.toLowerCase().trim();
      const activeCategory = document.querySelector('.category-btn.active').classList[1];
      
      let filteredBlogs = blogData;
      // 先按分类过滤
      if (activeCategory !== 'all') {
        filteredBlogs = filteredBlogs.filter(blog => blog.category === activeCategory);
      }
      // 再按关键词过滤
      if (searchInput) {
        filteredBlogs = filteredBlogs.filter(blog => 
          blog.title.toLowerCase().includes(searchInput) || 
          blog.keywords.toLowerCase().includes(searchInput) ||
          blog.excerpt.toLowerCase().includes(searchInput)
        );
      }
      renderBlogCards(filteredBlogs);
    }

    // 回车键搜索
    document.getElementById('searchInput').addEventListener('keyup', function(e) {
      if (e.key === 'Enter') {
        searchBlogs();
      }
    });

    // 窗口大小变化时更新画廊
    window.addEventListener('resize', function() {
      if (document.getElementById('imageGallery').classList.contains('gallery-active')) {
        updateGallerySlide();
      }
    });

    // 日期格式化函数（补全完整功能）
    function formatDate(dateStr) {
      const date = new Date(dateStr);
      const year = date.getFullYear();
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const day = String(date.getDate()).padStart(2, '0');
      return `${year}-${month}-${day}`;
    }

    // 页面加载完成后渲染所有博客卡片（关键新增）
    window.addEventListener('load', function() {
      renderBlogCards(blogData);
    });
  </script>